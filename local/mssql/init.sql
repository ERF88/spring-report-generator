--DATABASE
CREATE DATABASE investment;
GO

USE investment;
GO
--CONTRACT
CREATE TABLE CONTRACT
(
    CONTRACT_ID     INT PRIMARY KEY,
    CONTRACT_NUMBER VARCHAR(20),
    CONTRACT_DATE   DATE,
    TOTAL_AMOUNT    DECIMAL(18, 2)
);
GO

INSERT INTO CONTRACT
VALUES (1, 'C-001', '2025-01-01', 105000.00),
       (2, 'C-002', '2025-01-01', 110000.00),
       (3, 'C-003', '2025-01-01', 115000.00),
       (4, 'C-004', '2025-01-01', 120000.00),
       (5, 'C-005', '2025-01-01', 125000.00),
       (6, 'C-006', '2025-01-01', 130000.00),
       (7, 'C-007', '2025-01-01', 135000.00),
       (8, 'C-008', '2025-01-01', 140000.00),
       (9, 'C-009', '2025-01-01', 145000.00),
       (10, 'C-010', '2025-01-01', 150000.00),
       (11, 'C-011', '2024-02-01', 155000.00),
       (12, 'C-012', '2024-03-01', 160000.00),
       (13, 'C-013', '2024-04-01', 165000.00),
       (14, 'C-014', '2024-05-01', 170000.00),
       (15, 'C-015', '2024-06-01', 175000.00),
       (16, 'C-016', '2024-07-01', 180000.00),
       (17, 'C-017', '2024-08-01', 185000.00),
       (18, 'C-018', '2024-09-01', 190000.00),
       (19, 'C-019', '2024-10-01', 195000.00),
       (20, 'C-020', '2024-11-01', 200000.00);
GO

CREATE PROCEDURE SP_GET_CONTRACT_BY_DATE @CONTRACT_DATE DATE
AS
BEGIN
    SELECT * FROM CONTRACT WHERE CONTRACT_DATE = @CONTRACT_DATE;
END;
GO

--POSITION
CREATE TABLE POSITION
(
    POSITION_ID   INT PRIMARY KEY,
    CONTRACT_ID   INT,
    POSITION_DATE DATE,
    AMOUNT        DECIMAL(18, 2)
);
GO

INSERT INTO POSITION
VALUES (1, 1, '2025-01-01', 11000.00),
       (2, 2, '2025-01-01', 11500.00),
       (3, 3, '2025-01-01', 12000.00),
       (4, 4, '2025-01-01', 12500.00),
       (5, 5, '2025-01-01', 13000.00),
       (6, 6, '2025-01-01', 13500.00),
       (7, 7, '2025-01-01', 14000.00),
       (8, 8, '2025-01-01', 14500.00),
       (9, 9, '2025-01-01', 15000.00),
       (10, 10, '2025-01-01', 15500.00),
       (11, 11, '2024-02-15', 16000.00),
       (12, 12, '2024-03-15', 16500.00),
       (13, 13, '2024-04-15', 17000.00),
       (14, 14, '2024-05-15', 17500.00),
       (15, 15, '2024-06-15', 18000.00),
       (16, 16, '2024-07-15', 18500.00),
       (17, 17, '2024-08-15', 19000.00),
       (18, 18, '2024-09-15', 19500.00),
       (19, 19, '2024-10-15', 20000.00),
       (20, 20, '2024-11-15', 20500.00);
GO

CREATE PROCEDURE SP_GET_POSITION_BY_DATE @POSITION_DATE DATE
AS
BEGIN
    SELECT * FROM POSITION WHERE POSITION_DATE = @POSITION_DATE;
END;
GO

--TRANSACTION
CREATE TABLE MOVEMENT
(
    MOVEMENT_ID     INT PRIMARY KEY,
    CONTRACT_ID        INT,
    MOVEMENT_DATE   DATE,
    MOVEMENT_TYPE   VARCHAR(20),
    MOVEMENT_AMOUNT DECIMAL(18, 2)
);
GO

INSERT INTO MOVEMENT
VALUES (1, 1, '2025-01-01', 'CREDIT', 5400.00),
       (2, 2, '2025-01-01', 'CREDIT', 5800.00),
       (3, 3, '2025-01-01', 'CREDIT', 6200.00),
       (4, 4, '2025-01-01', 'CREDIT', 6600.00),
       (5, 5, '2025-01-01', 'CREDIT', 7000.00),
       (6, 6, '2025-01-01', 'CREDIT', 7400.00),
       (7, 7, '2025-01-01', 'CREDIT', 7800.00),
       (8, 8, '2025-01-01', 'CREDIT', 8200.00),
       (9, 9, '2025-01-01', 'CREDIT', 8600.00),
       (10, 10, '2025-01-01', 'CREDIT', 9000.00),
       (11, 11, '2024-02-25', 'DEBIT', 9400.00),
       (12, 12, '2024-03-25', 'DEBIT', 9800.00),
       (13, 13, '2024-04-25', 'DEBIT', 10200.00),
       (14, 14, '2024-05-25', 'DEBIT', 10600.00),
       (15, 15, '2024-06-25', 'DEBIT', 11000.00),
       (16, 16, '2024-07-25', 'DEBIT', 11400.00),
       (17, 17, '2024-08-25', 'DEBIT', 11800.00),
       (18, 18, '2024-09-25', 'DEBIT', 12200.00),
       (19, 19, '2024-10-25', 'DEBIT', 12600.00),
       (20, 20, '2024-11-25', 'DEBIT', 13000.00);
GO

CREATE PROCEDURE SP_GET_MOVEMENT_BY_DATE @MOVEMENT_DATE DATE
AS
BEGIN
    SELECT * FROM MOVEMENT WHERE MOVEMENT_DATE = @MOVEMENT_DATE;
END;
GO

--EVENT
CREATE TABLE EVENT
(
    EVENT_ID    INT PRIMARY KEY,
    CONTRACT_ID INT,
    DESCRIPTION VARCHAR(100),
    EVENT_DATE  DATE
);
GO

INSERT INTO EVENT
VALUES (1, 1, 'EVENT 1', '2025-01-01'),
       (2, 2, 'EVENT 2', '2025-01-01'),
       (3, 3, 'EVENT 3', '2025-01-01'),
       (4, 4, 'EVENT 4', '2025-01-01'),
       (5, 5, 'EVENT 5', '2025-01-01'),
       (6, 6, 'EVENT 6', '2025-01-01'),
       (7, 7, 'EVENT 7', '2025-01-01'),
       (8, 8, 'EVENT 8', '2025-01-01'),
       (9, 9, 'EVENT 9', '2025-01-01'),
       (10, 10, 'EVENT 10', '2025-01-01'),
       (11, 11, 'EVENT 11', '2024-02-10'),
       (12, 12, 'EVENT 12', '2024-03-10'),
       (13, 13, 'EVENT 13', '2024-04-10'),
       (14, 14, 'EVENT 14', '2024-05-10'),
       (15, 15, 'EVENT 15', '2024-06-10'),
       (16, 16, 'EVENT 16', '2024-07-10'),
       (17, 17, 'EVENT 17', '2024-08-10'),
       (18, 18, 'EVENT 18', '2024-09-10'),
       (19, 19, 'EVENT 19', '2024-10-10'),
       (20, 20, 'EVENT 20', '2024-11-10');
GO

CREATE PROCEDURE SP_GET_EVENT_BY_DATE @EVENT_DATE DATE
AS
BEGIN
    SELECT * FROM EVENT WHERE EVENT_DATE = @EVENT_DATE;
END;
GO

--BALANCE
CREATE TABLE BALANCE
(
    BALANCE_ID      INT PRIMARY KEY,
    CONTRACT_ID     INT,
    BALANCE_DATE    DATE,
    CURRENT_BALANCE DECIMAL(18, 2)
);
GO

INSERT INTO BALANCE
VALUES (1, 1, '2025-01-01', 96000.00),
       (2, 2, '2025-01-01', 97000.00),
       (3, 3, '2025-01-01', 98000.00),
       (4, 4, '2025-01-01', 99000.00),
       (5, 5, '2025-01-01', 100000.00),
       (6, 6, '2025-01-01', 101000.00),
       (7, 7, '2025-01-01', 102000.00),
       (8, 8, '2025-01-01', 103000.00),
       (9, 9, '2025-01-01', 104000.00),
       (10, 10, '2025-01-01', 105000.00),
       (11, 11, '2024-02-28', 106000.00),
       (12, 12, '2024-03-28', 107000.00),
       (13, 13, '2024-04-28', 108000.00),
       (14, 14, '2024-05-28', 109000.00),
       (15, 15, '2024-06-28', 110000.00),
       (16, 16, '2024-07-28', 111000.00),
       (17, 17, '2024-08-28', 112000.00),
       (18, 18, '2024-09-28', 113000.00),
       (19, 19, '2024-10-28', 114000.00),
       (20, 20, '2024-11-28', 115000.00);
GO

CREATE PROCEDURE SP_GET_BALANCE_BY_DATE @BALANCE_DATE DATE
AS
BEGIN
    SELECT * FROM BALANCE WHERE BALANCE_DATE = @BALANCE_DATE;
END;
GO

--SWAP
CREATE TABLE SWAP
(
    SWAP_ID     INT PRIMARY KEY,
    CONTRACT_ID INT,
    SWAP_DATE   DATE,
    SWAP_TYPE   VARCHAR(20),
    SWAP_AMOUNT DECIMAL(18, 2)
);
GO

INSERT INTO SWAP
VALUES (1, 1, '2025-01-01', 'FIXED', 5600.00),
       (2, 2, '2025-01-01', 'FIXED', 6200.00),
       (3, 3, '2025-01-01', 'FIXED', 6800.00),
       (4, 4, '2025-01-01', 'FIXED', 7400.00),
       (5, 5, '2025-01-01', 'FIXED', 8000.00),
       (6, 6, '2025-01-01', 'FIXED', 8600.00),
       (7, 7, '2025-01-01', 'FIXED', 9200.00),
       (8, 8, '2025-01-01', 'FIXED', 9800.00),
       (9, 9, '2025-01-01', 'FIXED', 10400.00),
       (10, 10, '2025-01-01', 'FIXED', 11000.00),
       (11, 11, '2024-02-20', 'FLOATING', 11600.00),
       (12, 12, '2024-03-20', 'FLOATING', 12200.00),
       (13, 13, '2024-04-20', 'FLOATING', 12800.00),
       (14, 14, '2024-05-20', 'FLOATING', 13400.00),
       (15, 15, '2024-06-20', 'FLOATING', 14000.00),
       (16, 16, '2024-07-20', 'FLOATING', 14600.00),
       (17, 17, '2024-08-20', 'FLOATING', 15200.00),
       (18, 18, '2024-09-20', 'FLOATING', 15800.00),
       (19, 19, '2024-10-20', 'FLOATING', 16400.00),
       (20, 20, '2024-11-20', 'FLOATING', 17000.00);
GO

CREATE PROCEDURE SP_GET_SWAP_BY_DATE @SWAP_DATE DATE
AS
BEGIN
    SELECT * FROM SWAP WHERE SWAP_DATE = @SWAP_DATE;
END;
GO